# IOPY
Python implementation to create or extract `.iop` files generated by IOPManager ([fork of Ziparchive by Artpol](https://www.artpol-software.com/ZipArchive/Default.aspx), used by [Lost Saga](https://lostsaga.hangame.com/))

This library deconstruct `.iop` file which then later can be extracted. Or construct `.iop` which automatically saves them to file or `BytesIO`.

# Usage
## Requirements
- **Python 3.11+**

## Installation
Run this command on command line
```sh
> git clone https://github.com/Trisnox/IOPY
> cd IOPY
> pip install .
```

## Extract .iop
Run python interpreter or create python script
```py
from iopy import IOPY
iop_archive = IOPY('path/to/file.iop', password='kr', dir='extract/' silent=False)
ipo_archive.extractall()
```
## Creating .iop
To create .iop, just simply supply either directory or any file that is not .iop
```py
from iopy import IOPY
IOPY('dir/', iop_filename='my_file.iop' password=None, silent=False) # Doesn't return anything, and is automically saved
```

# Help
## Functions
All of these functions can only be used for deconstructing only. `IOPY` return nothing if it was construncting file.
___
### `list_file()` -> `list[str]`
Returns a list of string containing all the filenames and their directories

Return:
- `list[str]`: Contains list of all files, excluding entry that only contains directory
___
### `extract()` -> `None | bool | io.BytesIO`
Extract the first item, or iter to the next one.

Return:
- `None`: operation is completed and is saved
- `False`: no more file to extract
- `BytesIO`: if `bytes_io` parameters is set to `True`, return this instead of `None`
___
### `extract_by_name(filename)` -> `None | bool | io.BytesIO | dict`
Extract by their filename

Return:
- `None`: file exist and is saved
- `False`: file not found
- `BytesIO`: if `bytes_io` parameter is set to `True` and file is found, returns this instead of `None`
- `dict`: same as `BytesIO`, if it result more than one file. The `dict` contains `{filename: io.BytesIO or [io.BytesIO, ..]}`
___
### `extract_all()` -> `None | dict`
Extract all contents inside the .iop file

Return:
- `None`: operation completed and is saved
- `dict`: if `bytes_io` parameter is set to `True`, returns this instead of `None`. The `dict` contains `{filename: io.BytesIO or [io.BytesIO, ..]}`

## Deconstructing
## Attributes
### file: `str`
The location of .iop file. If this file is an .iop, it will deconstruct it, otherwise it will be treated as constructing .iop file.

### dir: `str` (optional kwargs)
Directory used to extract files into. Defaults to current folder. Ignored for constructing, it will generate file on current directory

### include_dir: `bool` (optional kwargs)
Wherever to include directories (if any) when extracting the file(s). Defaults to `True`. May cause overwrites. Ignored for constructing

### password: `str` | `Nonetype` (optional kwargs)
Used to determine password used for .iop files, each region have different password. Defaults to `kr`.
If set to None, then encryption will not be used, will cause error for decryption

### bytes_io: `bool` (optional kwargs)
If set to `True`, then extract function will return `bytesIO` instead of saving the file. Defaults to `False`.

### silent: `bool` (optional kwargs)
If set to `False`, then the class will not print the saved filename. Defaults to `True`
___
## Constructing
### file: `str`
The location of .iop file. If this file is an .iop, it will deconstruct it, otherwise it will be treated as constructing .iop file

### iop_filename: `str` (optional kwargs)
Filename that will be used for generated archive file. If not provided, then the file/folder name will be used for the archive name instead. Ignored for deconstructing

### password: `str`|`Nonetype` Type (optional kwargs)
Used to determine password used for .iop files, each region have different password. Defaults to kr.
If set to `None`, then encryption will not be used, will cause error for decryption

### bytes_io: `bool` Type (optional kwargs)
If set to `True`, then extract function will return bytesIO instead of saving the file. Defaults to `False`

### silent: `bool` Type (optional kwargs)
If set to `True`, then the class will not print the saved filename. Defaults to True

# To-Do
- Inserting file(s)
- CLI automation (GUI is obsolete due to program already exist)